import{d as T,h as R,i,j as _,c as x,a as t,k as j,l as B,t as y,u as o,w as g,m as L,p as h,e as s,q as V,g as w,v as N,R as C,f as m,o as p,x as U,y as $,z as A}from"./index-Gs8EthlX.js";const D={class:"min-h-[calc(100vh-10rem)] flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8"},I={class:"w-full max-w-md"},M={class:"bg-white rounded-xl shadow-lg p-8"},z={class:"text-center mb-8"},P={class:"text-3xl font-bold text-gray-900"},W={class:"text-gray-600 mt-2"},G={class:"flex items-center justify-between"},H={class:"mt-6 text-center text-sm text-gray-600"},O=T({__name:"Login",setup(J){const F=U(),S=$(),d=R(),f=i(""),v=i(""),c=i(""),r=i(!1),n=i(""),u=i(!1);async function b(){n.value="",u.value=!0;try{const a=await A.post("/api/auth/login",{email:f.value,password:v.value,twoFactorCode:r.value?c.value:void 0});if(a.data.requiresTwoFactor){r.value=!0,u.value=!1;return}const{tokens:e,user:l}=a.data.data,k=e.accessToken;localStorage.setItem("token",k),d.$patch({token:k,user:l});const E=S.query.redirect;F.push(E||"/app")}catch(a){if(a&&typeof a=="object"&&"response"in a){const e=a;n.value=e.response?.data?.error||"Login failed"}else n.value="Login failed"}finally{u.value=!1}}function q(){r.value=!1,c.value="",n.value=""}return _(()=>{d.clearError()}),(a,e)=>(p(),x("div",D,[t("div",I,[t("div",M,[t("div",z,[t("h1",P,y(r.value?"Two-Factor Authentication":"Welcome back"),1),t("p",W,y(r.value?"Enter the code from your authenticator app":"Sign in to your account to continue"),1)]),o(d).error||n.value?(p(),j(o(L),{key:0,severity:"error",class:"mb-4"},{default:g(()=>[m(y(o(d).error||n.value),1)]),_:1})):B("",!0),r.value?(p(),x("form",{key:1,onSubmit:h(b,["prevent"]),class:"space-y-6"},[t("div",null,[e[3]||(e[3]=t("label",{for:"twoFactorCode",class:"block text-sm font-medium text-gray-700 mb-1"}," Authentication Code ",-1)),s(o(V),{id:"twoFactorCode",modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=l=>c.value=l),type:"text",inputmode:"numeric",pattern:"[0-9]*",maxlength:"6",placeholder:"000000",class:"w-full text-center text-2xl tracking-widest",required:"",autocomplete:"one-time-code"},null,8,["modelValue"]),e[4]||(e[4]=t("p",{class:"text-sm text-gray-500 mt-2"}," Enter the 6-digit code from your authenticator app ",-1))]),s(o(w),{type:"submit",label:"Verify Code",icon:"pi pi-shield",class:"w-full",loading:u.value},null,8,["loading"]),s(o(w),{type:"button",label:"Use different account",severity:"secondary",text:"",class:"w-full",onClick:q})],32)):(p(),x("form",{key:2,onSubmit:h(b,["prevent"]),class:"space-y-6"},[t("div",null,[e[5]||(e[5]=t("label",{for:"email",class:"block text-sm font-medium text-gray-700 mb-1"}," Email address ",-1)),s(o(V),{id:"email",modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=l=>f.value=l),type:"email",placeholder:"you@example.com",class:"w-full",required:"",autocomplete:"email"},null,8,["modelValue"])]),t("div",null,[e[6]||(e[6]=t("label",{for:"password",class:"block text-sm font-medium text-gray-700 mb-1"}," Password ",-1)),s(o(N),{id:"password",modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=l=>v.value=l),placeholder:"••••••••",class:"w-full",feedback:!1,"toggle-mask":"",required:"",autocomplete:"current-password"},null,8,["modelValue"])]),t("div",G,[e[8]||(e[8]=t("div",{class:"flex items-center"},[t("input",{id:"remember",type:"checkbox",class:"h-4 w-4 text-violet-600 border-gray-300 rounded focus:ring-violet-500"}),t("label",{for:"remember",class:"ml-2 text-sm text-gray-600"}," Remember me ")],-1)),s(o(C),{to:"/forgot-password",class:"text-sm text-violet-600 hover:text-violet-500"},{default:g(()=>[...e[7]||(e[7]=[m(" Forgot password? ",-1)])]),_:1})]),s(o(w),{type:"submit",label:"Sign In",icon:"pi pi-sign-in",class:"w-full",loading:u.value},null,8,["loading"])],32)),t("p",H,[e[10]||(e[10]=m(" Don't have an account? ",-1)),s(o(C),{to:"/signup",class:"text-violet-600 hover:text-violet-500 font-medium"},{default:g(()=>[...e[9]||(e[9]=[m(" Create one now ",-1)])]),_:1})])])])]))}});export{O as default};
