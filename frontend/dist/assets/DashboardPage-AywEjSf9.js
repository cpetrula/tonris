import{d as B,h as F,i as c,E as R,j as G,c as r,a as e,l as v,t as a,u as d,F as g,r as _,e as b,k as S,w as u,s as y,z as H,o as i,n as T,g as D,x as O}from"./index-Gs8EthlX.js";import{u as P}from"./tenant-jT8DLe2X.js";const L={class:"mb-8"},U={class:"text-2xl font-bold text-gray-900"},J={class:"text-gray-600 mt-1"},Y={key:0,class:"mb-6 p-4 bg-red-100 dark:bg-red-900/20 border border-red-400 dark:border-red-700 rounded-lg"},q={class:"text-red-800 dark:text-red-300"},I={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},K={class:"flex items-center"},Q={class:"ml-4"},W={class:"text-sm font-medium text-white-600"},X={class:"text-2xl font-bold text-white-900"},Z={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ee={class:"flex items-center justify-between"},te={class:"space-y-4"},se={class:"font-medium text-white-900"},oe={class:"text-sm text-white-600"},ae={class:"text-right"},ne={class:"text-sm font-medium text-violet-600"},ie={key:0,class:"text-center py-8 text-white-600"},le={class:"flex items-center justify-between"},re={class:"space-y-4"},de={class:"ml-3"},ce={class:"text-sm font-medium text-white-900"},ue={class:"text-sm text-white-600"},pe={class:"text-xs text-white-500 mt-1"},ve=B({__name:"DashboardPage",setup(me){const $=F(),M=P(),x=O(),w=c(!1),p=c(null),N=R(()=>{const o=new Date().getHours();return o<12?"Good morning":o<18?"Good afternoon":"Good evening"}),k=c([{label:"Today's Appointments",value:"0",icon:"pi pi-calendar",color:"bg-blue-500"},{label:"Pending Calls",value:"0",icon:"pi pi-phone",color:"bg-orange-500"},{label:"Active Employees",value:"0",icon:"pi pi-users",color:"bg-green-500"},{label:"Services Offered",value:"0",icon:"pi pi-list",color:"bg-purple-500"}]),f=c([]),h=c([]);function A(o){x.push(o)}function E(o){const s=["/app/appointments","/app/appointments","/app/employees","/app/services"];s[o]&&x.push(s[o])}function j(o){return new Date(o).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}function V(o){const s=new Date,t=new Date(o),l=s.getTime()-t.getTime(),n=Math.floor(l/6e4),m=Math.floor(n/60),C=Math.floor(m/24);return n<1?"Just now":n<60?`${n} minute${n===1?"":"s"} ago`:m<24?`${m} hour${m===1?"":"s"} ago`:C===1?"Yesterday":`${C} days ago`}async function z(){w.value=!0,p.value=null;try{const s=(await H.get("/api/tenant/dashboard-stats")).data.data;if(s.stats){const t={"Today's Appointments":"todayAppointments","Pending Calls":"pendingCalls","Active Employees":"activeEmployees","Services Offered":"servicesOffered"};k.value.forEach(l=>{const n=t[l.label];n&&s.stats[n]!==void 0&&(l.value=String(s.stats[n]))})}s.todayAppointments&&(f.value=s.todayAppointments.map(t=>({...t,time:j(t.time)}))),s.recentActivity&&(h.value=s.recentActivity.map(t=>({...t,time:V(t.timestamp)})))}catch(o){console.error("Failed to fetch dashboard data:",o),p.value="Failed to load dashboard data"}finally{w.value=!1}}return G(async()=>{await z()}),(o,s)=>(i(),r("div",null,[e("div",L,[e("h1",U,a(N.value)+", "+a(d($).user?.firstName||"User")+"! ",1),e("p",J," Here's what's happening with "+a(d(M).tenantName||"your business")+" today. ",1)]),p.value?(i(),r("div",Y,[e("p",q,a(p.value),1)])):v("",!0),e("div",I,[(i(!0),r(g,null,_(k.value,(t,l)=>(i(),S(d(y),{key:t.label,class:"shadow-sm cursor-pointer hover:shadow-md transition-shadow",onClick:n=>E(l)},{content:u(()=>[e("div",K,[e("div",{class:T([t.color,"w-12 h-12 rounded-lg flex items-center justify-center"])},[e("i",{class:T([t.icon,"text-xl text-white"])},null,2)],2),e("div",Q,[e("p",W,a(t.label),1),e("p",X,a(t.value),1)])])]),_:2},1032,["onClick"]))),128))]),e("div",Z,[b(d(y),{class:"shadow-sm"},{title:u(()=>[e("div",ee,[s[2]||(s[2]=e("span",null,"Today's Appointments",-1)),b(d(D),{label:"View All",text:"",size:"small",onClick:s[0]||(s[0]=t=>A("/app/appointments"))})])]),content:u(()=>[e("div",te,[(i(!0),r(g,null,_(f.value,t=>(i(),r("div",{key:t.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[e("div",null,[e("p",se,a(t.customerName),1),e("p",oe,a(t.service)+" with "+a(t.employee),1)]),e("div",ae,[e("p",ne,a(t.time),1)])]))),128)),f.value.length===0?(i(),r("div",ie," No appointments scheduled for today ")):v("",!0)])]),_:1}),h.value.length>0?(i(),S(d(y),{key:0,class:"shadow-sm"},{title:u(()=>[e("div",le,[s[3]||(s[3]=e("span",null,"Recent Activity",-1)),b(d(D),{label:"View Reports",text:"",size:"small",onClick:s[1]||(s[1]=t=>A("/app/reports"))})])]),content:u(()=>[e("div",re,[(i(!0),r(g,null,_(h.value,(t,l)=>(i(),r("div",{key:l,class:"flex items-start pb-4 border-b border-gray-200 last:border-0 last:pb-0"},[s[4]||(s[4]=e("div",{class:"w-2 h-2 mt-2 rounded-full bg-violet-500"},null,-1)),e("div",de,[e("p",ce,a(t.action),1),e("p",ue,a(t.item),1),e("p",pe,a(t.time),1)])]))),128))])]),_:1})):v("",!0)])]))}});export{ve as default};
