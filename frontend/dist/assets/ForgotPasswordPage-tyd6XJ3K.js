import{d as F,i as o,E as k,c as m,a as s,k as U,l as h,n as P,t as f,w as g,u as l,m as $,p as V,e as r,q as j,g as w,f as v,v as q,R,o as c,z as _}from"./index-D7omodB6.js";const L={class:"min-h-[calc(100vh-10rem)] flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8"},T={class:"w-full max-w-md"},Y={class:"bg-white rounded-xl shadow-lg p-8"},z={class:"text-center mb-8"},D={class:"text-3xl font-bold text-gray-900"},I={class:"text-gray-600 mt-2"},A={key:2,class:"space-y-6"},M={class:"bg-violet-50 rounded-lg p-4 text-center"},W={class:"text-violet-700"},G={class:"text-center space-y-4"},H={key:4,class:"space-y-6"},J={class:"mt-6 text-center text-sm text-gray-600"},X=F({__name:"ForgotPasswordPage",setup(K){const t=o("request"),i=o(""),x=o(""),n=o(""),y=o(""),u=o(!1),a=o(""),b=new URLSearchParams(window.location.search).get("token");b&&(x.value=b,t.value="reset");const C=k(()=>{switch(t.value){case"request":return"Forgot your password?";case"sent":return"Check your email";case"reset":return"Reset your password";case"success":return"Password reset successful";default:return"Forgot your password?"}}),E=k(()=>{switch(t.value){case"request":return"No worries, we'll send you reset instructions.";case"sent":return"We sent a password reset link to your email address.";case"reset":return"Enter your new password below.";case"success":return"Your password has been reset. You can now sign in with your new password.";default:return""}});async function N(){if(a.value="",!i.value.trim()){a.value="Email is required";return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.value)){a.value="Please enter a valid email address";return}u.value=!0;try{await _.post("/api/auth/forgot-password",{email:i.value}),t.value="sent"}catch{t.value="sent"}finally{u.value=!1}}async function S(){if(a.value="",!n.value){a.value="Password is required";return}if(n.value.length<8){a.value="Password must be at least 8 characters";return}if(n.value!==y.value){a.value="Passwords do not match";return}u.value=!0;try{await _.post("/api/auth/reset-password",{token:x.value,password:n.value}),t.value="success"}catch(d){if(d&&typeof d=="object"&&"response"in d){const e=d;a.value=e.response?.data?.error||"Failed to reset password. Please try again."}else a.value="Failed to reset password. Please try again."}finally{u.value=!1}}function B(){t.value="request"}return(d,e)=>(c(),m("div",L,[s("div",T,[s("div",Y,[s("div",z,[s("div",{class:P(["w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",t.value==="success"?"bg-green-100":"bg-violet-100"])},[s("i",{class:P(["text-3xl",t.value==="sent"?"pi pi-envelope text-violet-600":t.value==="success"?"pi pi-check-circle text-green-600":t.value==="reset"?"pi pi-lock text-violet-600":"pi pi-key text-violet-600"])},null,2)],2),s("h1",D,f(C.value),1),s("p",I,f(E.value),1)]),a.value?(c(),U(l($),{key:0,severity:"error",class:"mb-4"},{default:g(()=>[v(f(a.value),1)]),_:1})):h("",!0),t.value==="request"?(c(),m("form",{key:1,onSubmit:V(N,["prevent"]),class:"space-y-6"},[s("div",null,[e[3]||(e[3]=s("label",{for:"email",class:"block text-sm font-medium text-gray-700 mb-1"}," Email address ",-1)),r(l(j),{id:"email",modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=p=>i.value=p),type:"email",placeholder:"you@example.com",class:"w-full",required:"",autocomplete:"email"},null,8,["modelValue"])]),r(l(w),{type:"submit",label:"Send Reset Link",icon:"pi pi-send",class:"w-full",loading:u.value},null,8,["loading"])],32)):t.value==="sent"?(c(),m("div",A,[s("div",M,[s("p",W,[e[4]||(e[4]=s("i",{class:"pi pi-info-circle mr-2"},null,-1)),e[5]||(e[5]=v(" If an account exists for ",-1)),s("strong",null,f(i.value),1),e[6]||(e[6]=v(", you will receive an email with instructions to reset your password. ",-1))])]),s("div",G,[e[7]||(e[7]=s("p",{class:"text-sm text-gray-600"}," Didn't receive the email? Check your spam folder or ",-1)),r(l(w),{type:"button",label:"Try Again",severity:"secondary",outlined:"",onClick:B})])])):t.value==="reset"?(c(),m("form",{key:3,onSubmit:V(S,["prevent"]),class:"space-y-6"},[s("div",null,[e[8]||(e[8]=s("label",{for:"password",class:"block text-sm font-medium text-gray-700 mb-1"}," New Password ",-1)),r(l(q),{id:"password",modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=p=>n.value=p),placeholder:"••••••••",class:"w-full","toggle-mask":"",required:"",autocomplete:"new-password"},null,8,["modelValue"])]),s("div",null,[e[9]||(e[9]=s("label",{for:"confirmPassword",class:"block text-sm font-medium text-gray-700 mb-1"}," Confirm New Password ",-1)),r(l(q),{id:"confirmPassword",modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=p=>y.value=p),placeholder:"••••••••",class:"w-full",feedback:!1,"toggle-mask":"",required:"",autocomplete:"new-password"},null,8,["modelValue"])]),r(l(w),{type:"submit",label:"Reset Password",icon:"pi pi-lock",class:"w-full",loading:u.value},null,8,["loading"])],32)):t.value==="success"?(c(),m("div",H,[e[10]||(e[10]=s("div",{class:"bg-green-50 rounded-lg p-4 text-center"},[s("p",{class:"text-green-700"},[s("i",{class:"pi pi-check-circle mr-2"}),v(" Your password has been successfully reset. ")])],-1)),r(l(R),{to:"/login",class:"block"},{default:g(()=>[r(l(w),{label:"Sign In",icon:"pi pi-sign-in",class:"w-full"})]),_:1})])):h("",!0),s("p",J,[r(l(R),{to:"/login",class:"inline-flex items-center gap-1 text-violet-600 hover:text-violet-500 font-medium"},{default:g(()=>[...e[11]||(e[11]=[s("i",{class:"pi pi-arrow-left text-xs"},null,-1),v(" Back to sign in ",-1)])]),_:1})])])])]))}});export{X as default};
